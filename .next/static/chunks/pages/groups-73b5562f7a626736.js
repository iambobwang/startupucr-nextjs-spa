(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{3542:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groups",function(){return r(9976)}])},3412:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(5893),o=r(9875),i=r(9134),s=r.n(i);function a(e){let{children:t}=e;return(0,n.jsx)(o.E.main,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},layout:"position",className:s().layout,children:t})}},9976:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(5893),o=r(7294),i=r(9008),s=r.n(i),a=r(1664),u=r.n(a),c=r(8633),d=r(1163);let p=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");var l=r(9875),h=r(6501),g=r(3412),_=r(7913),m=r.n(_);function f(){let e=(0,d.useRouter)(),[t]=(0,c.kP)(),[r,i]=(0,o.useState)(!1);var s={};r||(s={hover:{scale:1.02},tap:{scale:.997}});let[a,u]=(0,o.useState)(!1),[p,g]=(0,o.useState)(""),_=e=>{u(!1),g(e.target.value)},f=async r=>{let n=await x(r),o=await y(t.user.id);if(""!==o)e.push("/groups/"+o),h.ZP.error("Already in a group! Leave your group to join a different one.",{id:"tryJoinGroupError"});else if(n.exists&&n.full)u(!0),h.ZP.error("Group is full. Try a different group.",{id:"fullGroupError"});else if(n.exists&&!n.full){var i="";1===n.users.length?i=n.users[0].name.toString():2===n.users.length?i=n.users[0].name.toString()+" and "+n.users[1].name.toString():3===n.users.length&&(i=n.users[0].name.toString()+", "+n.users[1].name.toString()+", and "+n.users[2].name.toString());let s=await j(t.user.id);b(s,i);let a=await w(n);for(let c=0;c<a.length;c++)v(a[c],t.user.name);u(!1),S(t.user.id,t.user.name,n.users),h.ZP.success("Successfully joined group!",{id:"joinGroupSuccess"});let d="/groups/"+r.toString();e.push(d)}else n.exists||(u(!0),h.ZP.error("Group does not exist. Try again.",{id:"groupError"}))},y=async e=>{let t=await fetch("/api/checkin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})}),r=await t.json();if(r.checkins[0])return r.checkins[0].groupId},j=async e=>{let t=await fetch("/api/checkin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e})}),r=await t.json();if(r.checkins[0])return r.checkins[0].email},w=async e=>{var t=[];for(let r=0;r<e.users.length;r++){let n=await fetch("/api/checkin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e.users[r].id})}),o=await n.json();o.checkins[0]&&t.push(o.checkins[0].email)}return t},x=async e=>{let t=await fetch("/api/groups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group:e})}),r=await t.json();var n=0!==Object.keys(r.groups).length,o=!1,i=[];return r.groups[0]&&(r.groups[0].users&&(o=4===r.groups[0].users.length),i=r.groups[0].users),{exists:n,full:o,users:i}},S=async(e,t,r)=>{r.push({id:e,name:t});let n=await fetch("/api/groups/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group:[p,e,r]})});await n.json()},b=async(e,r)=>{fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,template_id:"d-06a1b789e26343379dc0d93974a69d97",name:t.user.name,members:r,invite_code:p.toString(),newcomer:""})})},v=async(e,r)=>{fetch("/api/sendEmail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,template_id:"d-2d5a7dbaae4740509e1a982076fee102",name:t.user.name,members:"",invite_code:"",newcomer:r})})},k=()=>{i(window.innerWidth<=720)};return(0,o.useEffect)(()=>{window.addEventListener("resize",k)}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:m().inputWrapper,children:[(0,n.jsx)("div",{className:m().inputHeader,children:"Invite Code"}),(0,n.jsx)("input",{className:m().inputBox&&a?"".concat(m().inputBox," ").concat(m().triggeredBox):"".concat(m().inputBox),value:p,onChange:_})]}),(0,n.jsx)(l.E.button,{"aria-label":"Join Group Button",type:"button",variants:s,whileHover:"hover",whileTap:"tap",transition:{ease:"easeInOut",duration:.015},className:m().button,onClick:()=>f(p),children:"Join Group"})]})}function y(){let e=(0,d.useRouter)(),[t,r]=(0,c.kP)(),[i,a]=(0,o.useState)(!1);var _={};i||(_={hover:{scale:1.02},tap:{scale:.997}});let[y,j]=(0,o.useState)(!1),[w,x]=(0,o.useState)(""),S=async t=>{let r=await fetch("/api/checkin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t})}),n=await r.json();if(0===Object.keys(n.checkins).length&&(e.push("/checkin"),h.ZP.error("Access denied. Please check in!",{id:"notCheckedInGroupPageError"})),n.checkins[0]){if(x(n.checkins[0].qualified),"yes"!==n.checkins[0].qualified)e.push("/"),h.ZP.error("Access denied. Application has not been approved yet or has been denied.",{id:"notQualifiedYetError"});else if(j(""!==n.checkins[0].groupId),""!==n.checkins[0].groupId){let o="/groups/"+n.checkins[0].groupId.toString();e.push(o)}}},b=async(t,r)=>{let n=p(),o=await fetch("/api/groups/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group:[n,t,r]})});await o.json(),h.ZP.success("Successfully created a group!",{id:"createGroupSuccess"});let i="/groups/"+n.toString();e.push(i)},v=()=>{a(window.innerWidth<=720)};return((0,o.useEffect)(()=>{window.addEventListener("resize",v),r||t?t&&S(t.user.id):(e.push("/signin"),h.ZP.error("Access denied. Please sign in!",{id:"notSignedInGroupError"}))},[r,t,e]),r||"yes"!==w||y)?(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(s(),{children:(0,n.jsx)("title",{children:"Cutie Hack | Groups"})}),(0,n.jsx)("p",{children:"Loading..."})]}):(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(s(),{children:(0,n.jsx)("title",{children:"Cutie Hack | Groups"})}),(0,n.jsx)("div",{className:m().container,children:(0,n.jsxs)("div",{className:m().section,children:[(0,n.jsxs)("div",{className:m().groupbuttonWrapper,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:m().groupbuttonHeader,children:[(0,n.jsx)("h2",{children:"Join a Group"}),(0,n.jsx)("p",{children:"Have a group to join? Enter the invite code below!"})]}),(0,n.jsx)(f,{})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:m().groupbuttonHeader,children:[(0,n.jsx)("h2",{children:"Create a Group"}),(0,n.jsx)("p",{children:"Don't have a group to join? Create your own below!"})]}),(0,n.jsx)(l.E.button,{"aria-label":"Create Group Button",type:"button",variants:_,whileHover:"hover",whileTap:"tap",transition:{ease:"easeInOut",duration:.015},className:m().button,onClick:()=>b(t.user.id,t.user.name),children:"Create Group"})]})]}),(0,n.jsx)(u(),{passHref:!0,href:"/",children:(0,n.jsx)(l.E.button,{"aria-label":"Home Button",type:"button",variants:_,whileHover:"hover",whileTap:"tap",transition:{ease:"easeInOut",duration:.015},className:"".concat(m().button," ").concat(m().home),children:"Go Back to Homepage"})})]})})]})}},7913:function(e){e.exports={container:"Form_container__QZyVS",section:"Form_section__En4Pt",mainContent:"Form_mainContent__O0Kcr",button:"Form_button__Jsx6p",home:"Form_home__iOoqR",danger:"Form_danger__s1kTK",cancel:"Form_cancel__taASY",inputWrapper:"Form_inputWrapper__nUW_B",inputHeader:"Form_inputHeader__GrJuy",trigger:"Form_trigger__OIRXb",inputBox:"Form_inputBox__sJnvz",dropdown:"Form_dropdown__f9RCB",dropdownHeader:"Form_dropdownHeader__XchyQ",dropdownSelected:"Form_dropdownSelected__EuX6m",dropdownContent:"Form_dropdownContent__H6BNk",show:"Form_show__pe3Bj",radio:"Form_radio__KTpgW",errorMsg:"Form_errorMsg__K4hyJ",triggered:"Form_triggered__buxMD",triggeredBox:"Form_triggeredBox__65jjq",groupbuttonWrapper:"Form_groupbuttonWrapper__wTA22",groupbuttonHeader:"Form_groupbuttonHeader__FXnjC"}},9134:function(e){e.exports={layout:"Layout_layout__k3ZVO"}},9008:function(e,t,r){e.exports=r(3121)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3542)}),_N_E=e.O()}]);